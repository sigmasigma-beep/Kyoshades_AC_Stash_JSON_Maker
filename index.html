<!DOCTYPE html>
<html lang="en">
<head>

<script src="https://www.gstatic.com/firebasejs/10.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.6.1/firebase-analytics-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.6.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.6.1/firebase-storage-compat.js"></script>

<script>
  window.addEventListener('load', () => {
    const firebaseConfig = {
      apiKey: "AIzaSyA2flW3Fd4SPYihrsa-mtp2i6Zei_0wO8M",
      authDomain: "stash-gen-api.firebaseapp.com",
      projectId: "stash-gen-api",
      storageBucket: "stash-gen-api.appspot.com",
      messagingSenderId: "151976728938",
      appId: "1:151976728938:web:0dc8e3f6573bd1b9126d13",
      measurementId: "G-2GFFXME00R"
    };

    firebase.initializeApp(firebaseConfig);
    const analytics = firebase.analytics();
    const db = firebase.firestore();
    const storage = firebase.storage();

    console.log('Firebase initialized successfully!');
  });
</script>

  
<meta charset="UTF-8" />
<title>Kyoshade's Sigma Stash JSON Maker</title>
<style>
  @font-face {
    font-family: 'Kode Mono';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url(https://fonts.gstatic.com/s/kodemono/v3/A2BLn5pb0QgtVEPFnlYkkaoBgw4qv9odq5myxDOZadW2.woff2) format('woff2');
    unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
  }
  @font-face {
    font-family: 'Kode Mono';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url(https://fonts.gstatic.com/s/kodemono/v3/A2BLn5pb0QgtVEPFnlYkkaoBgw4qv9odq5myxD2ZaQ.woff2) format('woff2');
    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
  }

  html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    background: #000E00; 
    font-family: 'Kode Mono', monospace;
    color: #39ff14;
  }

#store-section {
  margin-top: 2rem;
}

#store-list {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

.store-block {
  border: 1px solid #39ff14;
  background: #003300;
  padding: 8px;
  width: calc(25% - 12px); /* 4 per row */
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.store-block h4 {
  margin: 0;
  font-size: 14px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.store-block pre {
  background: #001a00;
  border: 1px solid #39ff14;
  padding: 6px;
  max-height: 150px;
  overflow-y: auto;
  display: none; /* hidden by default */
  font-size: 12px;
}

.store-block button {
  font-size: 12px;
  padding: 4px 6px;
  margin-top: 2px;
  cursor: pointer;
}

  
  #app {
    max-width: 1000px;
    margin: auto;
    padding: 2rem;
  }

  h1 {
    font-size: 3em;
    font-weight: normal;
    color: #39ff14;
    text-align: center;
    padding: 0.5rem;
    margin-bottom: 2rem;
    background: #003300;
    border: 1px solid #39ff14;
  }

  #style-toggle {
    text-align: right;
    margin-bottom: 1rem;
  }
  #styleSelect {
    font-family: 'Kode Mono', monospace;
    background: #003000;
    color: #39ff14;
    font-size: 16px;
    padding: 6px 10px;
    border: 1px solid #39ff14;
  }

  #filename {
    display: block;
    width: 300px;
    margin-bottom: 1rem;
    font-size: 18px;
    padding: 10px;
    border: 1px solid #39ff14;
    background: #003000;
    color: #39ff14; 
  }

  .item-block {
    border: 1px solid #39ff14;
    background: #003300;
    padding: 16px;
    margin-bottom: 2rem;
  }

  label {
    font-size: 20px;
    padding: 10px;
    margin-bottom: 0.5rem;
    background: #003000;
    border: 1px solid #39ff14;
    display: block;
  }

  input[type="text"],
  select {
    height: 50px;
    font-size: 20px;
    background: #003000;
    color: #39ff14; 
    border: 1px solid #39ff14;
    width: 100%;
  }
  input::placeholder {
    color: #66ff66;
    font-style: italic;
  }
  input:focus, select:focus {
    outline: 2px solid #39ff14;
  }

  .slider-container {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
    width: 320px;
  }
  .slider-container label {
    min-width: 90px;
  }
  .slider-container span {
    width: 40px;
    text-align: center;
    font-variant-numeric: tabular-nums;
  }
  input[type="range"] {
    -webkit-appearance: none;
    width: 220px;
    height: 25px;
    margin: 0 4px;
    background: #003000;
    border: 1px solid #39ff14;
    cursor: pointer;
  }
  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 30px;
    height: 30px;
    background: #39ff14;
    cursor: pointer;
    border-radius: 5px;
    border: none;
  }
  input[type="range"]:focus {
    outline: none;
  }

  .item-row {
    margin-bottom: 10px;
  }

  .item-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: center;
  }

  .item-controls > * {
    flex: none;
  }

  button {
    background: #003300;
    color: #39ff14;
    border: 1px solid #39ff14;
    padding: 6px 12px;
    font-size: 16px;
    cursor: pointer;
    border-radius: 4px;
  }
  button:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }

  #json-output {
    white-space: pre-wrap;
    background: #001a00;
    border: 1px solid #39ff14;
    padding: 1rem;
    margin-top: 1rem;
    font-size: 14px;
    max-height: 300px;
    overflow-y: auto;
  }
</style>
</head>
<body>
<div id="app">
  <h1>Kyoshade's Sigma Stash JSON Maker</h1>

  <input id="filename" type="text" placeholder="Enter filename :3" />

  <div id="editor"></div>

  <button id="addRootBtn">+ Add root item</button>
  <button id="downloadBtn">Download JSON</button>

  <pre id="json-output"></pre>


</script>

<div id="store-section">
  <h2>JSON Store</h2>
  <input type="file" id="store-file-input" accept=".json" />
  <input type="text" id="store-tags" placeholder="Enter tags, comma-separated" />
  <button id="store-upload-btn">Upload JSON</button>
  <input type="text" id="store-search" placeholder="Search store by name or tag" />
  <div id="store-list"></div>
</div>

<script>
  const storeFileInput = document.getElementById('store-file-input');
  const storeUploadBtn = document.getElementById('store-upload-btn');
  const storeList = document.getElementById('store-list');
  const storeTagsInput = document.getElementById('store-tags');
  const storeSearchInput = document.getElementById('store-search');

  const bannedWords = ['badword1','badword2','slur1','slur2'];

  async function uploadJSONFile() {
    const file = storeFileInput.files[0];
    if (!file) return alert('Select a JSON file first.');

    const tags = storeTagsInput.value.split(',').map(t => t.trim().toLowerCase()).filter(Boolean);
    for (let tag of tags) {
      for (let banned of bannedWords) {
        if (tag.includes(banned)) return alert('Invalid tag: ' + tag);
      }
    }

    try {
      const storageFileRef = storage.ref('jsonStore/' + Date.now() + '_' + file.name);
      await storageFileRef.put(file);
      const downloadURL = await storageFileRef.getDownloadURL();

      await db.collection('jsonStore').add({
        name: file.name,
        tags,
        storagePath: storageFileRef.fullPath,
        url: downloadURL,
        timestamp: firebase.firestore.FieldValue.serverTimestamp()
      });

      storeFileInput.value = '';
      storeTagsInput.value = '';
      renderStore();
      alert('Upload successful!');
    } catch (err) {
      console.error(err);
      alert('Upload failed!');
    }
  }

  storeUploadBtn.addEventListener('click', uploadJSONFile);

  function createStoreBlock(item) {
    const block = document.createElement('div');
    block.className = 'store-block';

    const title = document.createElement('h4');
    title.textContent = item.name;
    block.appendChild(title);

    const tagDiv = document.createElement('div');
    tagDiv.textContent = 'Tags: ' + (item.tags?.join(', ') || 'None');
    tagDiv.style.fontSize = '12px';
    block.appendChild(tagDiv);

    const pre = document.createElement('pre');
    block.appendChild(pre);

    const toggleBtn = document.createElement('button');
    toggleBtn.textContent = 'Show Preview';
    toggleBtn.onclick = async () => {
      if (pre.style.display === 'none') {
        const res = await fetch(item.url);
        const data = await res.json();
        pre.textContent = JSON.stringify(data, null, 2);
        pre.style.display = 'block';
        toggleBtn.textContent = 'Hide Preview';
      } else {
        pre.style.display = 'none';
        toggleBtn.textContent = 'Show Preview';
      }
    };
    block.appendChild(toggleBtn);

    const downloadBtn = document.createElement('button');
    downloadBtn.textContent = 'Download';
    downloadBtn.onclick = () => {
      const a = document.createElement('a');
      a.href = item.url;
      a.download = item.name || 'stash.json';
      a.click();
    };
    block.appendChild(downloadBtn);

    return block;
  }

  async function renderStore() {
    storeList.innerHTML = '';
    const searchQuery = storeSearchInput.value.trim().toLowerCase();

    const snapshot = await db.collection('jsonStore').orderBy('timestamp', 'desc').get();
    snapshot.forEach(doc => {
      const item = doc.data();
      const matches = !searchQuery ||
        item.name.toLowerCase().includes(searchQuery) ||
        (item.tags && item.tags.some(tag => tag.includes(searchQuery)));

      if (matches) {
        storeList.appendChild(createStoreBlock(item));
      }
    });
  }

  storeSearchInput.addEventListener('input', renderStore);

  // Initial store render
  renderStore();
</script>


</script>

</div>



  
  
</div>

<script>
  let clipboard = null;

  const model = [];

  const editorDiv = document.getElementById('editor');
  const outputPre = document.getElementById('json-output');
  const filenameInput = document.getElementById('filename');
  const downloadBtn = document.getElementById('downloadBtn');
  const addRootBtn = document.getElementById('addRootBtn');

  // Sample item options for the dropdown
const itemOptions = [
  'item_apple',
  'item_anti_gravity_grenade',
  'item_arrow',
  'item_arrow_heart',
  'item_arrow_lightbulb',
  'item_arena_pistol',
  'item_arena_shotgun',
  'item_backpack',
  'item_backpack_black',
  'item_backpack_green',
  'item_backpack_large_base',
  'item_backpack_large_clover',
  'item_backpack_large_basketball',
  'item_backpack_pink',
  'item_backpack_small_base',
  'item_backpack_white',
  'item_backpack_with_flashlight',
  'item_balloon',
  'item_balloon_heart',
  'item_banana',
  'item_baseball_bat',
  'item_big_cup',
  'item_boombox',
  'item_box_fan',
  'item_boombox_neon',
  'item_calculator',
  'item_cardboard_box',
  'item_cash',
  'item_cash_pile',
  'item_cash_mega_pile',
  'item_clapper',
  'item_cluster_grenade',
  'item_cola',
  'item_cola_large',
  'item_company_ration',
  'item_company_ration_heal',
  'item_cracker',
  'item_crate',
  'item_crossbow',
  'item_crossbow_heart',
  'item_crowbar',
  'item_disc',
  'item_disposable_camera',
  'item_dynamite',
  'item_dynamite_cube',
  'item_hawaiian_drum',
  'item_egg',
  'item_flaregun',
  'item_flashbang',
  'item_flashlight',
  'item_flashlight_mega',
  'item_flashlight_red',
  'item_floppy3',
  'item_floppy5',
  'item_football',
  'item_frying_pan',
  'item_glowstick',
  'item_goldbar',
  'item_grenade',
  'item_heart_chunk',
  'item_heart_gun',
  'item_heartchocolatebox',
  'item_hh_key',
  'item_hookshot',
  'item_hookshot_sword',
  'item_hoverpad',
  'item_impulse_grenade',
  'item_jetpack',
  'item_keycard',
  'item_lance',
  'item_large_banana',
  'item_mug',
  'item_landmine',
  'item_nut',
  'item_ogre_hands',
  'item_ore_copper_l',
  'item_ore_copper_m',
  'item_ore_copper_s',
  'item_ore_gold_l',
  'item_ore_gold_m',
  'item_ore_gold_s',
  'item_ore_hell',
  'item_ore_silver_l',
  'item_ore_silver_m',
  'item_ore_silver_s',
  'item_painting_canvas',
  'item_paperpack',
  'item_pelican_case',
  'item_pickaxe',
  'item_pickaxe_cny',
  'item_pickaxe_cube',
  'item_pipe',
  'item_pinata_bat',
  'item_plunger',
  'item_pogostick',
  'item_police_baton',
  'item_pumpkin_pie',
  'item_pumpkinjack',
  'item_pumpkinjack_small',
  'item_quiver',
  'item_quiver_heart',
  'item_radioactive_broccoli',
  'item_broccoli_grenade',
  'item_broccoli_shrink_grenade',
  'item_randombox_mobloot_big',
  'item_randombox_mobloot_medium',
  'item_randombox_mobloot_small',
  'item_randombox_mobloot_weapons',
  'item_revolver',
  'item_revolver_ammo',
  'item_rope',
  'item_rpg',
  'item_rpg_spear',
  'item_rpg_ammo',
  'item_rpg_ammo_spear',
  'item_rpg_cny',
  'item_rubberducky',
  'item_ruby',
  'item_saddle',
  'item_scanner',
  'item_scissors',
  'item_shield',
  'item_shield_bones',
  'item_shield_police',
  'item_shotgun',
  'item_shotgun_ammo',
  'item_shredder',
  'item_shrinking_broccoli',
  'item_snowball',
  'item_stapler',
  'item_stick_armbones',
  'item_stick_bone',
  'item_sticker_dispenser',
  'item_sticky_dynamite',
  'item_stinky_cheese',
  'item_tablet',
  'item_tapedispenser',
  'item_tele_grenade',
  'item_theremin',
  'item_timebomb',
  'item_toilet_paper',
  'item_toilet_paper_mega',
  'item_toilet_paper_roll_empty',
  'item_treestick',
  'item_tripwire_explosive',
  'item_trophy',
  'item_turkey_leg',
  'item_turkey_whole',
  'item_umbrella',
  'item_umbrella_clover',
  'item_unidentified',
  'item_ukulele',
  'item_ukulele_gold',
  'item_upsidedown_loot',
  'item_uranium_chunk_l',
  'item_uranium_chunk_m',
  'item_uranium_chunk_s',
  'item_whoopie',
  'item_zipline_gun',
  'item_rpg_easter',
  'item_rpg_ammo_egg',
  'item_revolver_gold',
  'item_viking_hammer',
  'item_viking_hammer_twilight',
  'item_zombie_meat',
  'item_randombox_mobloot_zombie',
  'item_shield_viking_1',
  'item_shield_viking_2',
  'item_shield_viking_3',
  'item_shield_viking_4',
  'item_arrow_teleport',
  'item_arrow_bomb',
  'item_portable_teleporter',
  'item_drill',
  'item_ceo_plaque',
  'item_d20',
  'item_electrical_tape',
  'item_eraser',
  'item_finger_board',
  'item_gameboy',
  'item_goldcoin',
  'item_harddrive',
  'item_rare_card',
  'item_server_pad',
  'item_teleport_gun',
  'item_golden_grenade',
  'item_cutie_dead',
  'item_friend_launcher',
  'item_grenade_launcher',
  'item_goopfish',
  'item_goop',
  'item_boomerang',
  'item_ring_buoy',
  'item_wood_log'
];


  function createSlider(labelText, min, max, step, value, onChange) {
    const container = document.createElement('div');
    container.className = 'slider-container';

    const label = document.createElement('label');
    label.textContent = labelText;

    const slider = document.createElement('input');
    slider.type = 'range';
    slider.min = min;
    slider.max = max;
    slider.step = step;
    slider.value = value;

    const display = document.createElement('span');
    display.textContent = value;

    slider.oninput = e => {
      onChange(e);
      display.textContent = e.target.value;
      updateOutput();
    };

    container.appendChild(label);
    container.appendChild(slider);
    container.appendChild(display);

    return container;
  }

  function renderItems(items, container) {
    container.innerHTML = '';
    items.forEach((item, idx) => {
      const row = document.createElement('div');
      row.className = 'item-row';

      const controls = document.createElement('div');
      controls.className = 'item-controls';

  
      const toggleBtn = document.createElement('button');
      toggleBtn.className = 'toggle-children';
      toggleBtn.textContent = item.expanded ? '-' : '+';
      toggleBtn.title = item.expanded ? 'Collapse children' : 'Expand children';
      toggleBtn.onclick = () => {
        item.expanded = !item.expanded;
        renderEditor();
      };
      controls.appendChild(toggleBtn);


            const itemIDSelect = document.createElement('select');
      itemIDSelect.className = 'itemID';
      itemIDSelect.title = 'Select or type item ID';

      // Always include a blank option
      const blankOption = document.createElement('option');
      blankOption.value = '';
      blankOption.textContent = '(none)';
      itemIDSelect.appendChild(blankOption);

      // Build all predefined options
      itemOptions.forEach(opt => {
        const option = document.createElement('option');
        option.value = opt;
        option.textContent = opt;
        itemIDSelect.appendChild(option);
      });

      // If the current itemID isnâ€™t in itemOptions, add it manually
      if (item.itemID && !itemOptions.includes(item.itemID)) {
        const customOption = document.createElement('option');
        customOption.value = item.itemID;
        customOption.textContent = item.itemID + " (custom)";
        itemIDSelect.appendChild(customOption);
      }

      // Finally set the value
      itemIDSelect.value = item.itemID || '';

      itemIDSelect.oninput = e => {
        item.itemID = e.target.value;
        updateOutput();
      };
      itemIDSelect.onchange = e => {
        item.itemID = e.target.value;
        updateOutput();
      };
      controls.appendChild(itemIDSelect);

      controls.appendChild(itemIDSelect);


      controls.appendChild(createSlider('Hue:', 0, 210, 1, item.colorHue, e => item.colorHue = parseInt(e.target.value)));
      controls.appendChild(createSlider('Saturation:', 0, 120, 1, item.colorSaturation, e => item.colorSaturation = parseInt(e.target.value)));
      controls.appendChild(createSlider('Scale Modifier:', -127, 127, 1, item.scaleModifier, e => item.scaleModifier = parseFloat(e.target.value)));


      const copyBtn = document.createElement('button');
      copyBtn.textContent = 'Copy';
      copyBtn.title = 'Copy this item';
      copyBtn.onclick = () => {
        clipboard = JSON.parse(JSON.stringify(item)); 
        pasteBtn.disabled = false;
        console.log('Copied:', clipboard);
      };
      controls.appendChild(copyBtn);

 
      const pasteBtn = document.createElement('button');
      pasteBtn.textContent = 'Paste';
      pasteBtn.title = 'Paste copied item as a child';
      pasteBtn.disabled = !clipboard; 
      pasteBtn.onclick = () => {
        if (clipboard) {
          if (!item.children) item.children = [];
          item.children.push(JSON.parse(JSON.stringify(clipboard))); 
          item.expanded = true;
          renderEditor();
        }
      };
      controls.appendChild(pasteBtn);


      const removeBtn = document.createElement('button');
      removeBtn.textContent = 'x';
      removeBtn.title = 'Remove item';
      removeBtn.onclick = () => {
        items.splice(idx, 1);
        renderEditor();
      };
      controls.appendChild(removeBtn);


      const addChildBtn = document.createElement('button');
      addChildBtn.textContent = '+ Child';
      addChildBtn.title = 'Add child item';
      addChildBtn.onclick = () => {
        if (!item.children) item.children = [];
        item.children.push({
          itemID: '',
          colorHue: 0,
          colorSaturation: 0,
          scaleModifier: 0,
          children: [],
          expanded: true
        });
        item.expanded = true;
        renderEditor();
      };
      controls.appendChild(addChildBtn);

      row.appendChild(controls);


      const childrenContainer = document.createElement('div');
      childrenContainer.style.marginLeft = '20px';
      if (item.children && item.expanded) {
        renderItems(item.children, childrenContainer);
      }
      row.appendChild(childrenContainer);

      container.appendChild(row);
    });
  }

  function renderEditor() {
    renderItems(model, editorDiv);
    updateOutput();
  }

  function updateOutput() {
    function clean(itemOrItems) {
      if (Array.isArray(itemOrItems)) {
        return itemOrItems.map(({ expanded, children, ...rest }) => {
          const cleanedItem = { ...rest };
          if (children && children.length > 0) {
            cleanedItem.children = clean(children);
          }
          return cleanedItem;
        });
      } else if (itemOrItems && typeof itemOrItems === 'object') {
        const { expanded, children, ...rest } = itemOrItems;
        const cleanedItem = { ...rest };
        if (children && children.length > 0) {
          cleanedItem.children = clean(children);
        }
        return cleanedItem;
      }
      return itemOrItems;
    }

    if (model.length === 1) {
      outputPre.textContent = JSON.stringify(clean(model[0]), null, 2);
    } else {
      outputPre.textContent = JSON.stringify(clean(model), null, 2);
    }
  }

  function downloadJSON() {
    const blob = new Blob([outputPre.textContent], { type: 'application/json' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    const filename = filenameInput.value.trim() || 'stash';
    a.download = filename + '.json';
    a.click();
    URL.revokeObjectURL(a.href);
  }

  addRootBtn.addEventListener('click', () => {
    model.push({
      itemID: '',
      colorHue: 0,
      colorSaturation: 0,
      scaleModifier: 0,
      children: [],
      expanded: true
    });
    renderEditor();
  });


  
  downloadBtn.addEventListener('click', downloadJSON);

  renderEditor();
</script>
</body>
</html>

